{"version":3,"file":"vue.js","sources":["../../src/observer/array.js","../../src/observer/index.js","../../src/state.js","../../src/init.js","../../src/index.js"],"sourcesContent":["const arrayProto = Array.prototype //拿到数组原型上的方法\n\n//继承  arrayMethods.proto = arrayProto\nexport const arrayMethods = Object.create(arrayProto)\n\n// 当我们在arrayMethods上添加要重写的方法，用户使用这些方法就会走进重写的方法，如果使用其他方法会在原型链上找到\n\n//要重写的方法\nconst methods = ['push', 'pop', 'shift', 'unshift', 'splice', 'sort', 'reverse']\n\nmethods.forEach((method) => {\n  arrayMethods[method] = function (...args) {\n    // console.log(method+\"被调用了\")\n    const result = arrayProto[method].apply(this, args)\n    const ob=this.__ob__\n    let inserted\n    switch (method) {\n      case 'push':\n      case 'unshift': //这两个方法都是追加，如果追加的内容是对象类型，再次做劫持\n        inserted = args\n        break;\n      case 'splice':\n        inserted = args.slice(2)\n        console.log(inserted)\n        break;\n    }\n    if (inserted) ob.observeArray(inserted)\n    return result\n  }\n})\n","import { arrayMethods } from \"./array\"\n\nclass Observer {\n  constructor(value) {\n    // 判断一个对象是否被观测过,看有没有__ob__属性\n    Object.defineProperty(value, \"__ob__\", {\n      enumerable: false,//不可枚举\n      configurable:false,//不可修改\n      value:this//onserver实例\n    })\n\n    if (Array.isArray(value)) {\n      value.__proto__ = arrayMethods\n\n      this.observeArray(value)\n    } else {\n      this.walk(value)\n    }\n  }\n  walk(obj) {\n    let keys = Object.keys(obj) //获取对象的key\n\n    keys.forEach((key) => {\n      defineReactive(obj, key, obj[key])\n    })\n  }\n  observeArray(items){\n    for (let i = 0; i < items.length; i++) {\n      observe(items[i])\n      \n    }\n  }\n}\n\nfunction defineReactive(obj, key, value) {\n  observe(value)\n  Object.defineProperty(obj, key, {\n    get() {\n      console.log('get', value)\n      return value\n    },\n    set(newVal) {\n      if (newVal === value) return\n      observe(newVal) //如果用户将值改为对象继续拦截添加set和get\n      value = newVal\n      console.log(\"set\",value)\n    },\n  })\n}\n\nexport function observe(data) {\n  if (typeof data !== 'object' || typeof data === null) {\n    return data\n  }\n  if(data.__ob__){\n    return data\n  }\n  return new Observer(data)\n}\n","import { observe } from \"./observer/index\"\n\n\nexport function initState(vm){ //vm.$options\n  const opts = vm.$options \n\n  if(opts.props){\n    initProps(vm,opts.props)\n  }\n  if(opts.methods){\n    initMethods(vm,opts.methods)\n  }\n  if(opts.data){\n    initData(vm)\n  }\n  if (opts.computed) initComputed(vm, opts.computed)\n  if (opts.watch) {\n    initWatch(vm, opts.watch)\n  }\n}\n\nfunction initProps(vm){}\nfunction initMethods(vm){}\nfunction initData(vm){\n  let data=vm.$options.data\n\n  vm._data=data= typeof data===\"function\" ? data.call(vm) :data\n\n\n  //数据的劫持方案 ：对象 Object.defineProperty\n  // 数组单独处理\n\n  observe(data)\n\n}\nfunction initComputed(){vm}\nfunction initWatch(vm){}","import {initState} from './state'\nexport function initMixin(Vue) {\n  Vue.prototype._init = function (options) {\n    const vm= this;\n\n    vm.$options=options\n    \n\n    // 初始化状态,data、props、watch、computed \n    initState(vm)\n  };\n}","import {initMixin} from './init'\n\nfunction Vue(options){\n  \n  // console.log(options)\n  this._init(options)\n}\n\ninitMixin(Vue)\nexport default Vue"],"names":[],"mappings":";;;;;;EAAA,MAAM,UAAU,GAAG,KAAK,CAAC,UAAS;AAClC;EACA;EACO,MAAM,YAAY,GAAG,MAAM,CAAC,MAAM,CAAC,UAAU,EAAC;AACrD;EACA;AACA;EACA;EACA,MAAM,OAAO,GAAG,CAAC,MAAM,EAAE,KAAK,EAAE,OAAO,EAAE,SAAS,EAAE,QAAQ,EAAE,MAAM,EAAE,SAAS,EAAC;AAChF;EACA,OAAO,CAAC,OAAO,CAAC,CAAC,MAAM,KAAK;EAC5B,EAAE,YAAY,CAAC,MAAM,CAAC,GAAG,UAAU,GAAG,IAAI,EAAE;EAC5C;EACA,IAAI,MAAM,MAAM,GAAG,UAAU,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,IAAI,EAAE,IAAI,EAAC;EACvD,IAAI,MAAM,EAAE,CAAC,IAAI,CAAC,OAAM;EACxB,IAAI,IAAI,SAAQ;EAChB,IAAI,QAAQ,MAAM;EAClB,MAAM,KAAK,MAAM,CAAC;EAClB,MAAM,KAAK,SAAS;EACpB,QAAQ,QAAQ,GAAG,KAAI;EACvB,QAAQ,MAAM;EACd,MAAM,KAAK,QAAQ;EACnB,QAAQ,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,EAAC;EAChC,QAAQ,OAAO,CAAC,GAAG,CAAC,QAAQ,EAAC;EAC7B,QAAQ,MAAM;EACd,KAAK;EACL,IAAI,IAAI,QAAQ,EAAE,EAAE,CAAC,YAAY,CAAC,QAAQ,EAAC;EAC3C,IAAI,OAAO,MAAM;EACjB,IAAG;EACH,CAAC;;EC3BD,MAAM,QAAQ,CAAC;EACf,EAAE,WAAW,CAAC,KAAK,EAAE;EACrB;EACA,IAAI,MAAM,CAAC,cAAc,CAAC,KAAK,EAAE,QAAQ,EAAE;EAC3C,MAAM,UAAU,EAAE,KAAK;EACvB,MAAM,YAAY,CAAC,KAAK;EACxB,MAAM,KAAK,CAAC,IAAI;EAChB,KAAK,EAAC;AACN;EACA,IAAI,IAAI,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE;EAC9B,MAAM,KAAK,CAAC,SAAS,GAAG,aAAY;AACpC;EACA,MAAM,IAAI,CAAC,YAAY,CAAC,KAAK,EAAC;EAC9B,KAAK,MAAM;EACX,MAAM,IAAI,CAAC,IAAI,CAAC,KAAK,EAAC;EACtB,KAAK;EACL,GAAG;EACH,EAAE,IAAI,CAAC,GAAG,EAAE;EACZ,IAAI,IAAI,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,GAAG,EAAC;AAC/B;EACA,IAAI,IAAI,CAAC,OAAO,CAAC,CAAC,GAAG,KAAK;EAC1B,MAAM,cAAc,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,GAAG,CAAC,EAAC;EACxC,KAAK,EAAC;EACN,GAAG;EACH,EAAE,YAAY,CAAC,KAAK,CAAC;EACrB,IAAI,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;EAC3C,MAAM,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,EAAC;EACvB;EACA,KAAK;EACL,GAAG;EACH,CAAC;AACD;EACA,SAAS,cAAc,CAAC,GAAG,EAAE,GAAG,EAAE,KAAK,EAAE;EACzC,EAAE,OAAO,CAAC,KAAK,EAAC;EAChB,EAAE,MAAM,CAAC,cAAc,CAAC,GAAG,EAAE,GAAG,EAAE;EAClC,IAAI,GAAG,GAAG;EACV,MAAM,OAAO,CAAC,GAAG,CAAC,KAAK,EAAE,KAAK,EAAC;EAC/B,MAAM,OAAO,KAAK;EAClB,KAAK;EACL,IAAI,GAAG,CAAC,MAAM,EAAE;EAChB,MAAM,IAAI,MAAM,KAAK,KAAK,EAAE,MAAM;EAClC,MAAM,OAAO,CAAC,MAAM,EAAC;EACrB,MAAM,KAAK,GAAG,OAAM;EACpB,MAAM,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,KAAK,EAAC;EAC9B,KAAK;EACL,GAAG,EAAC;EACJ,CAAC;AACD;EACO,SAAS,OAAO,CAAC,IAAI,EAAE;EAC9B,EAAE,IAAI,OAAO,IAAI,KAAK,QAAQ,IAAI,OAAO,IAAI,KAAK,IAAI,EAAE;EACxD,IAAI,OAAO,IAAI;EACf,GAAG;EACH,EAAE,GAAG,IAAI,CAAC,MAAM,CAAC;EACjB,IAAI,OAAO,IAAI;EACf,GAAG;EACH,EAAE,OAAO,IAAI,QAAQ,CAAC,IAAI,CAAC;EAC3B;;ECvDO,SAAS,SAAS,CAAC,EAAE,CAAC;EAC7B,EAAE,MAAM,IAAI,GAAG,EAAE,CAAC,SAAQ;AAC1B;EACA,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC;EAChB,IAAI,SAAS,CAAC,EAAE,CAAC,IAAI,CAAC,KAAK,EAAC;EAC5B,GAAG;EACH,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC;EAClB,IAAI,WAAW,CAAC,EAAE,CAAC,IAAI,CAAC,OAAO,EAAC;EAChC,GAAG;EACH,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC;EACf,IAAI,QAAQ,CAAC,EAAE,EAAC;EAChB,GAAG;EACH,EAAE,IAAI,IAAI,CAAC,QAAQ,EAAE,YAAY,CAAC,EAAE,EAAE,IAAI,CAAC,QAAQ,EAAC;EACpD,EAAE,IAAI,IAAI,CAAC,KAAK,EAAE;EAClB,IAAI,SAAS,CAAC,EAAE,EAAE,IAAI,CAAC,KAAK,EAAC;EAC7B,GAAG;EACH,CAAC;AACD;EACA,SAAS,SAAS,CAAC,EAAE,CAAC,EAAE;EACxB,SAAS,WAAW,CAAC,EAAE,CAAC,EAAE;EAC1B,SAAS,QAAQ,CAAC,EAAE,CAAC;EACrB,EAAE,IAAI,IAAI,CAAC,EAAE,CAAC,QAAQ,CAAC,KAAI;AAC3B;EACA,EAAE,EAAE,CAAC,KAAK,CAAC,IAAI,EAAE,OAAO,IAAI,GAAG,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,KAAI;AAC/D;AACA;EACA;EACA;AACA;EACA,EAAE,OAAO,CAAC,IAAI,EAAC;AACf;EACA,CAAC;EACD,SAAS,YAAY,EAAE,CAAC,GAAE,CAAC;EAC3B,SAAS,SAAS,CAAC,EAAE,CAAC;;ECnCf,SAAS,SAAS,CAAC,GAAG,EAAE;EAC/B,EAAE,GAAG,CAAC,SAAS,CAAC,KAAK,GAAG,UAAU,OAAO,EAAE;EAC3C,IAAI,MAAM,EAAE,EAAE,IAAI,CAAC;AACnB;EACA,IAAI,EAAE,CAAC,QAAQ,CAAC,QAAO;EACvB;AACA;EACA;EACA,IAAI,SAAS,CAAC,EAAE,EAAC;EACjB,GAAG,CAAC;EACJ;;ECTA,SAAS,GAAG,CAAC,OAAO,CAAC;EACrB;EACA;EACA,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO,EAAC;EACrB,CAAC;AACD;EACA,SAAS,CAAC,GAAG;;;;;;;;"}